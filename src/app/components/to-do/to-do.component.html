<div class="main">
  <div class="sidebar">
    <form [formGroup]="toDoForm">
      <div>
        <label>Enter the title of task:</label>
        <input
          class="form-control"
          placeholder="task title"
          formControlName="item"
        />
        @if (hasError('item', 'required')) {
        <small class="text-danger">Title is required.</small>
        } @else if (hasError('item', 'minlength')) {
        <small class="text-danger">Title must be at least 3 characters.</small>
        }
      </div>

      <div>
        <label>Deadline:</label>
        <input
          class="form-control"
          type="date"
          placeholder="Date"
          formControlName="date"
        />
        @if(hasError('date' , 'required')){
          <small class="text-danger">Deadline is required</small>
        }

      </div>

      <div>
        <label> Priority:</label>
        <select formControlName="priority" class="form-control">
          <option value="high" selected>High</option>
          <option value="medium">Medium</option>
          <option value="low">Low</option>
        </select>
      </div>

      <div>
        <label>Description:</label>
        <input
          class="form-control"
          placeholder="Description"
          formControlName="description"
        />
        @if(hasError('description' , 'required')){
          <small class="text-danger">this is required.</small>
        }
        @else if (hasError('description' , 'minlength')) {
          <small class="text-danger"> Min lengath must be at least 10 characters.</small>
        }
        @else if (hasError('description' , 'maxlength')) {
          <small class="text-danger"> Maximun length is 30 character.</small>
        }
      </div>

      <div class="btn">
        @if(!isEditEnabled){
        <!-- //when need to add task in tasks -->
        <button
          (click)="addTask()"
          class="btn btn-primary"
          [disabled]="toDoForm.invalid"
        >
          Add
        </button>
        } @else{
        <!-- //when make edit in task attached at (tasks) make update -->
        <button (click)="updateTask()" class="btn btn-primary">Update</button>
        }
      </div>
    </form>
  </div>

  <div class="actions">
    <div class="tasks">
      <!-- //tasks -->
      <h2>
        Backlog @if(tasks.length>0){
        <Span>{{ tasks.length }}</Span>
        }
      </h2>
      <div
        cdkDropList
        #todoList1="cdkDropList"
        [cdkDropListData]="tasks"
        [cdkDropListConnectedTo]="[todoList2]"
        class="example-list"
        (cdkDropListDropped)="drop($event)"
      >
        @for (task of tasks; track task) {
        <div class="task" cdkDrag>
          <div class="head-task">
            <h6>{{ task.title }}</h6>
            <p class="task-priority">{{ task.priority }}</p>
          </div>
          <div class="content-task">
            <div class="example-box">{{ task.description }}</div>
            <p class="content-deadline">Due To : {{ task.deadline }}</p>

            <!--Buttons of Edit and Delete-->
            <div
              style="
                display: flex;
                gap: 20px;
                margin-top: 15px;
                justify-content: flex-start;
              "
            >
              <!-- Edit Button -->
              <button
                style="
                  background: none;
                  color: #007bff;
                  border: none;
                  font-size: 14px;
                  cursor: pointer;
                  font-weight: 600;
                  text-transform: uppercase;
                  letter-spacing: 1px;
                  transition: color 0.3s ease;
                "
                title="Edit"
                onclick="alert('Edit clicked!')"
                (click)="editTask($index, task)"
              >
                Edit
              </button>
              <!-- Delete Button -->
              <button
                style="
                  background: none;
                  color: #e53e3e;
                  border: none;
                  font-size: 14px;
                  cursor: pointer;
                  font-weight: 600;
                  text-transform: uppercase;
                  letter-spacing: 1px;
                  transition: color 0.3s ease;
                "
                title="Delete"
                onclick="alert('Delete clicked!')"
                (click)="deleteTask($index)"
              >
                Delete
              </button>
            </div>
          </div>
        </div>

        }
      </div>
    </div>

    <div class="tasks">
      <!-- //inprogress -->
      <h2>
        In progress @if(inProgress.length>0){
        <Span>{{ inProgress.length }}</Span>
        }
      </h2>
      <div
        cdkDropList
        #todoList2="cdkDropList"
        [cdkDropListData]="inProgress"
        [cdkDropListConnectedTo]="[todoList3]"
        class="example-list"
        (cdkDropListDropped)="drop($event)"
      >
        @for (item of inProgress; track item) {
        <div class="task" cdkDrag>
          <div class="head-task">
            <h6>{{ item.title }}</h6>
            <p class="task-priority">{{ item.priority }}</p>
          </div>
          <div class="content-task">
            <div class="example-box">{{ item.description }}</div>
            <p class="content-deadline">Due To : {{ item.deadline }}</p>

            <!--Buttons -->
            <div
              style="
                display: flex;
                gap: 20px;
                margin-top: 15px;
                justify-content: flex-start;
              "
            >
              <!-- Delete Button -->
              <button
                style="
                  background: none;
                  color: #e53e3e;
                  border: none;
                  font-size: 14px;
                  cursor: pointer;
                  font-weight: 600;
                  text-transform: uppercase;
                  letter-spacing: 1px;
                  transition: color 0.3s ease;
                "
                title="Delete"
                onclick="alert('Delete clicked!')"
                (click)="deleteInprogressTask($index)"
              >
                Delete
              </button>
            </div>
          </div>
        </div>

        }
      </div>
    </div>

    <!-- //done -->

    <div class="tasks">
      <!-- //inprogress -->
      <!-- //tasks -->
      <h2>
        Done @if(done.length>0){
        <Span>{{ done.length }}</Span>
        }
      </h2>
      <div
        cdkDropList
        #todoList3="cdkDropList"
        [cdkDropListData]="done"
        [cdkDropListConnectedTo]="[todoList1]"
        class="example-list"
        (cdkDropListDropped)="drop($event)"
      >
        @for (item of done; track item) {
        <div class="task" cdkDrag>
          <div class="head-task">
            <h6>{{ item.title }}</h6>
            <p class="task-priority">{{ item.priority }}</p>
          </div>
          <div class="content-task">
            <div class="example-box">{{ item.description }}</div>
            <p class="content-deadline">Due To : {{ item.deadline }}</p>

            <!--Button-->
            <div
              style="
                display: flex;
                gap: 20px;
                margin-top: 15px;
                justify-content: flex-start;
              "
            >
              <!-- Delete Button -->
              <button
                style="
                  background: none;
                  color: #e53e3e;
                  border: none;
                  font-size: 14px;
                  cursor: pointer;
                  font-weight: 600;
                  text-transform: uppercase;
                  letter-spacing: 1px;
                  transition: color 0.3s ease;
                "
                title="Delete"
                onclick="alert('Delete clicked!')"
                (click)="deleteDoneTask($index)"
              >
                Delete
              </button>
            </div>
          </div>
        </div>
        }
      </div>
    </div>
  </div>
</div>
